 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/backend/app/crud.py b/backend/app/crud.py
index a9609b7f0596477949a23de97974deecb786d3ff..1e9ef667c5fb35ec4a360022e3a4cc6c539d3bf8 100644
--- a/backend/app/crud.py
+++ b/backend/app/crud.py
@@ -280,63 +280,82 @@ def generate_account_number_for_email(email: str) -> str:
     digest = hashlib.sha1(normalized.encode("utf-8")).hexdigest()[:8].upper()
     return f"ACC-{digest}"
 
 
 # ---------------------------------------------------------------------------
 # Twilio / WhatsApp helper
 # ---------------------------------------------------------------------------
 # ---------------------------------------------------------------------------
 # Twilio / WhatsApp helper
 # ---------------------------------------------------------------------------
 
 twilio_client = None
 if os.getenv("TWILIO_ACCOUNT_SID"):
     print("[WhatsApp debug] TWILIO_ACCOUNT_SID is set")
     twilio_client = Client(
         os.getenv("TWILIO_ACCOUNT_SID"),
         os.getenv("TWILIO_AUTH_TOKEN"),
     )
 else:
     print("[WhatsApp debug] TWILIO_ACCOUNT_SID is NOT set")
 
 FROM_NUMBER = os.getenv("TWILIO_WHATSAPP_FROM")
 print(f"[WhatsApp debug] FROM_NUMBER = {FROM_NUMBER!r}")
 
 
+def normalize_whatsapp_number(value: Optional[str]) -> str:
+    if not value:
+        return ""
+    normalized = str(value)
+    if not normalized.startswith("whatsapp:"):
+        normalized = f"whatsapp:{normalized}"
+    return normalized
+
+
 def send_whatsapp(to: str, body: str) -> None:
     """Send a WhatsApp message, or log a preview if Twilio isn't configured."""
     print(
         "[WhatsApp debug] send_whatsapp called with: "
         f"client={bool(twilio_client)}, FROM={FROM_NUMBER!r}, to={to!r}"
     )
+    normalized_from = normalize_whatsapp_number(FROM_NUMBER)
+    normalized_to = normalize_whatsapp_number(to)
+    print(
+        "[WhatsApp debug] normalized numbers: "
+        f"FROM={normalized_from!r}, TO={normalized_to!r}"
+    )
 
-    if not twilio_client or not to or not FROM_NUMBER:
+    if not twilio_client or not normalized_to or not normalized_from:
         print(f"[WhatsApp Preview] To {to}: {body}")
         return
 
     try:
-        msg = twilio_client.messages.create(from_=FROM_NUMBER, body=body, to=to)
+        msg = twilio_client.messages.create(
+            from_=normalized_from,
+            body=body,
+            to=normalized_to,
+        )
         print(f"[WhatsApp debug] Twilio message SID: {msg.sid}")
     except Exception as e:
         print(f"WhatsApp error: {e}")
 
 
 def notify_booking_created(
     customer: Optional[models.User],
     provider_user: Optional[models.User],
     service: models.Service,
     booking: models.Booking,
 ) -> None:
     """Send all notifications for a newly confirmed booking.
 
     - WhatsApp to customer (if configured)
     - WhatsApp to provider (if configured)
     - Push to customer (if configured)
     - Push to provider (if configured)
     """
     if not (customer and provider_user):
         return
 
     # Customer: one confirmation message
     if customer.whatsapp:
         send_whatsapp(
             customer.whatsapp,
 
EOF
)