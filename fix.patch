 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/mobile/App.js b/mobile/App.js
index 35da6a451758713da5112a7e2f3787fd8888dd81..39943a86e693841225bbee7ae4cad1bd2aec089a 100644
--- a/mobile/App.js
+++ b/mobile/App.js
@@ -122,63 +122,81 @@ const resolveImageUrl = (url) => {
 const toNum = (value) => {
   const n = typeof value === "string" ? parseFloat(value) : value;
   return Number.isFinite(n) ? n : null;
 };
 
 const getDistanceKm = (lat1, lon1, lat2, lon2) => {
   if (lat1 == null || lon1 == null || lat2 == null || lon2 == null) {
     return null;
   }
   const toRad = (value) => (value * Math.PI) / 180;
   const R = 6371;
   const dLat = toRad(lat2 - lat1);
   const dLon = toRad(lon2 - lon1);
   const a =
     Math.sin(dLat / 2) * Math.sin(dLat / 2) +
     Math.cos(toRad(lat1)) *
       Math.cos(toRad(lat2)) *
       Math.sin(dLon / 2) *
       Math.sin(dLon / 2);
   const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
   const distance = R * c;
   return Number.isFinite(distance) ? distance : null;
 };
 
 const getProviderCoords = (provider) => {
+  const location = provider?.location;
+  const pinnedLocation = provider?.pinned_location ?? provider?.pinnedLocation;
+  const coords = provider?.coords;
   const lat = toNum(
     provider?.pinned_lat ??
       provider?.pinnedLatitude ??
+      pinnedLocation?.lat ??
+      pinnedLocation?.latitude ??
+      location?.lat ??
+      location?.latitude ??
       provider?.location_lat ??
       provider?.locationLat ??
+      coords?.lat ??
+      coords?.latitude ??
       provider?.latitude ??
       provider?.lat
   );
   const lng = toNum(
     provider?.pinned_lng ??
       provider?.pinnedLongitude ??
+      pinnedLocation?.lng ??
+      pinnedLocation?.long ??
+      pinnedLocation?.longitude ??
+      location?.lng ??
+      location?.long ??
+      location?.longitude ??
       provider?.location_lng ??
       provider?.locationLng ??
+      coords?.lng ??
+      coords?.long ??
+      coords?.longitude ??
       provider?.longitude ??
       provider?.lng ??
       provider?.lon
   );
   if (lat == null || lng == null) return null;
   return { lat, lng };
 };
 
 const LEGACY_ACCESS_TOKEN_KEY = "accessToken";
 
 const getAuthToken = async (tokenState) => {
   if (tokenState?.token) return tokenState.token;
 
   try {
     const secure = await withTimeout(loadToken(), 1500, "loadToken");
     if (secure) return secure;
   } catch (error) {
     console.log("[auth] Failed to load secure token", error?.message || error);
   }
 
   try {
     const legacy = await withTimeout(
       AsyncStorage.getItem(LEGACY_ACCESS_TOKEN_KEY),
       1500,
       "loadLegacyToken"
@@ -2966,50 +2984,79 @@ function SearchScreen({ token, showFlash, navigation, route, toggleFavorite, isF
     }
     const toRad = (v) => (v * Math.PI) / 180;
     const R = 6371; // km
     const dLat = toRad(lat2 - lat1);
     const dLon = toRad(lon2 - lon1);
     const a =
       Math.sin(dLat / 2) * Math.sin(dLat / 2) +
       Math.cos(toRad(lat1)) *
         Math.cos(toRad(lat2)) *
         Math.sin(dLon / 2) *
         Math.sin(dLon / 2);
     const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
     return R * c;
   };
 
   const getClientCoords = () => {
     if (!clientLocation) return null;
     const lat = toNum(clientLocation.lat ?? clientLocation.latitude);
     const lng = toNum(
       clientLocation.lng ?? clientLocation.long ?? clientLocation.longitude
     );
     if (lat == null || lng == null) return null;
     return { lat, lng };
   };
 
+  useEffect(() => {
+    if (clientLocation) return;
+    let isMounted = true;
+
+    const loadStoredClientLocation = async () => {
+      try {
+        const stored = await AsyncStorage.getItem("clientLocation");
+        if (!stored) return;
+        const parsed = JSON.parse(stored);
+        const lat = toNum(parsed?.lat ?? parsed?.latitude);
+        const long = toNum(
+          parsed?.long ?? parsed?.lng ?? parsed?.longitude
+        );
+        if (lat == null || long == null) return;
+        if (isMounted) {
+          setClientLocation({ lat, long });
+        }
+      } catch (error) {
+        console.log("Error loading stored client location", error);
+      }
+    };
+
+    loadStoredClientLocation();
+
+    return () => {
+      isMounted = false;
+    };
+  }, [clientLocation]);
+
 
   const handleSearchSubmit = () => {
     // when the user hits enter/search on the keyboard
     setHasSearched(true);
     setShouldScrollToResults(true);
   };
 
 
   const loadProviders = useCallback(async () => {
     try {
       setProvidersLoading(true);
       setProvidersError("");
 
       const res = await axios.get(`${API}/providers`);
 
       // Always normalize the result to an array
       const list = Array.isArray(res.data)
         ? res.data
         : res.data?.providers || [];
 
       setProviders(list);
       setFilteredProviders(list);
       syncFavoritesFromList(list);
       return list;
     } catch (err) {
 
EOF
)