 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/backend/tests/test_billing.py b/backend/tests/test_billing.py
index 0231bf6115fc68489e64c2cad079ea5408d11c15..0f5f7326b015e2f47d9e3e54f726a9684704dd85 100644
--- a/backend/tests/test_billing.py
+++ b/backend/tests/test_billing.py
@@ -100,50 +100,87 @@ def test_cancelled_booking_not_billable(db_session):
 
 def test_cancelled_booking_not_auto_completed(db_session):
     session, models, crud = db_session
     provider, customer, service = _create_provider_graph(session, models)
 
     now = datetime.utcnow()
     start_time = _current_month_past_time(now) - timedelta(hours=1)
     end_time = start_time + timedelta(hours=1)
 
     booking = _add_booking(
         session,
         models,
         customer=customer,
         service=service,
         start_time=start_time,
         end_time=end_time,
         status="cancelled",
     )
 
     crud._auto_complete_finished_bookings(session, as_of=now)
     session.refresh(booking)
 
     assert booking.status == "cancelled"
 
 
+def test_cancelling_booking_updates_monthly_bill(db_session):
+    session, models, crud = db_session
+    provider, customer, service = _create_provider_graph(session, models)
+
+    now = datetime.utcnow()
+    start_time = _current_month_past_time(now)
+    end_time = start_time + timedelta(hours=1)
+
+    booking = _add_booking(
+        session,
+        models,
+        customer=customer,
+        service=service,
+        start_time=start_time,
+        end_time=end_time,
+        status="completed",
+    )
+
+    crud.generate_monthly_bills(session, month=now.date())
+
+    bill = (
+        session.query(models.Bill)
+        .filter(models.Bill.provider_id == provider.id)
+        .first()
+    )
+
+    assert bill is not None
+    assert float(bill.total_gyd) > 0
+
+    crud.cancel_booking_for_customer(session, booking.id, customer.id)
+
+    session.refresh(bill)
+
+    assert float(bill.total_gyd) == 0
+    assert float(bill.fee_gyd) == 0
+
+
 def test_completed_booking_counts_toward_fees(db_session):
     session, models, crud = db_session
     provider, customer, service = _create_provider_graph(session, models)
 
     now = datetime.utcnow()
     start_time = _current_month_past_time(now)
     end_time = start_time + timedelta(hours=1)
 
     _add_booking(
         session,
         models,
         customer=customer,
         service=service,
         start_time=start_time,
         end_time=end_time,
         status="completed",
     )
 
     # Add noise bookings that shouldn't count
     future_start = now + timedelta(days=1)
     future_end = future_start + timedelta(hours=1)
     _add_booking(
         session,
         models,
         customer=customer,
 
EOF
)