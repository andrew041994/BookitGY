 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/backend/tests/test_provider_suspension.py b/backend/tests/test_provider_suspension.py
index 7b4090ccc04c31412e0f6c3778766fc1de985d24..55f7779e5b2320b76381f26744996cb27b407e9e 100644
--- a/backend/tests/test_provider_suspension.py
+++ b/backend/tests/test_provider_suspension.py
@@ -1,26 +1,26 @@
-from datetime import timedelta
+from datetime import datetime, timedelta
 
 import pytest
 from fastapi import HTTPException
 from app import schemas
 from app.utils.time import now_guyana
 
 
 def _create_user(session, crud, *, email, username, password, is_provider=False, is_suspended=False):
     user = crud.create_user(
         session,
         schemas.UserCreate(
             username=username,
             email=email,
             password=password,
             phone="000000",
             location="Georgetown",
         ),
     )
     user.is_email_verified = True
     user.is_provider = is_provider
     user.is_suspended = is_suspended
     session.commit()
     session.refresh(user)
     return user
 
@@ -166,25 +166,97 @@ def test_booking_creation_allows_unsuspended_provider(db_session):
 
     provider = crud.get_or_create_provider_for_user(session, provider_user.id)
     service = _create_service(session, models, provider.id)
 
     customer_user = _create_user(
         session,
         crud,
         email="customer3@example.com",
         username="customer3",
         password="Password",
     )
     from app.routes.bookings import create_booking_for_me
 
     booking_payload = schemas.BookingCreate(
         service_id=service.id,
         start_time=now_guyana() + timedelta(hours=3),
     )
 
     booking = create_booking_for_me(
         booking_in=booking_payload,
         db=session,
         current_user=customer_user,
     )
 
     assert booking is not None
+
+
+def test_provider_confirm_auto_locked_when_current_cycle_unpaid_after_cutoff(db_session, monkeypatch):
+    session, models, crud = db_session
+
+    provider_user = _create_user(
+        session,
+        crud,
+        email="provider5@example.com",
+        username="provider_autolock",
+        password="Password",
+        is_provider=True,
+        is_suspended=False,
+    )
+    provider = crud.get_or_create_provider_for_user(session, provider_user.id)
+    service = _create_service(session, models, provider.id)
+
+    customer_user = _create_user(
+        session,
+        crud,
+        email="customer5@example.com",
+        username="customer5",
+        password="Password",
+    )
+
+    fixed_now = datetime(2026, 2, 17, 8, 0, 0)
+    monkeypatch.setattr("app.crud.now_guyana", lambda: fixed_now)
+
+    booking = models.Booking(
+        customer_id=customer_user.id,
+        service_id=service.id,
+        start_time=fixed_now - timedelta(hours=3),
+        end_time=fixed_now - timedelta(hours=2),
+        status="completed",
+    )
+    session.add(booking)
+
+    current_cycle = crud.current_billing_cycle_month(fixed_now.date())
+    session.add(
+        models.BillingCycle(
+            account_number=provider.account_number,
+            cycle_month=current_cycle,
+            is_paid=False,
+        )
+    )
+
+    pending_booking = models.Booking(
+        customer_id=customer_user.id,
+        service_id=service.id,
+        start_time=fixed_now + timedelta(hours=2),
+        end_time=fixed_now + timedelta(hours=3),
+        status="pending",
+    )
+    session.add(pending_booking)
+    session.commit()
+    session.refresh(provider)
+
+    from app.routes.bookings import confirm_booking_as_provider
+
+    with pytest.raises(HTTPException) as exc_info:
+        confirm_booking_as_provider(
+            booking_id=pending_booking.id,
+            db=session,
+            provider=provider,
+        )
+
+    session.refresh(provider)
+    assert exc_info.value.status_code == 403
+    assert exc_info.value.detail == (
+        "Provider account is locked and cannot accept or confirm new appointments."
+    )
+    assert provider.is_locked is True
 
EOF
)