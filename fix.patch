 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/backend/app/crud.py b/backend/app/crud.py
index b8ddabfa8f7aef79573a7bf4d7fd1ce102a02446..d3d4bfe1d81b853c67c84b45d2b46c52322cdd70 100644
--- a/backend/app/crud.py
+++ b/backend/app/crud.py
@@ -689,67 +689,68 @@ def generate_monthly_bills(db: Session, month: date):
             existing_bill.total_gyd = total
             existing_bill.fee_gyd = fee
             existing_bill.due_date = due
         else:
             bill = models.Bill(
                 provider_id=prov.id,
                 month=start,
                 total_gyd=total,
                 fee_gyd=fee,
                 due_date=due,
             )
             db.add(bill)
 
     db.commit()
 
 
 
 
 
 def get_provider_fees_due(db: Session, provider_id: int) -> float:
     """
     Amount due for the most recent unpaid bill for this provider, in GYD.
 
     This mirrors the "Total due" shown on the provider-facing bill by:
     - Taking the latest unpaid bill (so we don't aggregate across months),
-    - Using the total bill amount (total_gyd), and
+    - Using only the platform fee amount (fee_gyd), and
     - Applying any available bill credits.
     """
     latest_unpaid_bill = (
         db.query(models.Bill)
         .filter(
             models.Bill.provider_id == provider_id,
             models.Bill.is_paid == False,
         )
         .order_by(models.Bill.due_date.desc())
         .first()
     )
 
     if not latest_unpaid_bill:
         return 0.0
 
-    total_due = Decimal(str(latest_unpaid_bill.total_gyd or 0))
+    # Billing for providers should only charge the platform fee, not their gross booking revenue.
+    total_due = Decimal(str(latest_unpaid_bill.fee_gyd or 0))
     credits = Decimal(str(get_provider_credit_balance(db, provider_id) or 0))
 
     net_due = total_due - credits
     if net_due < 0:
         net_due = Decimal("0")
 
     return float(net_due)
 
 
 def _provider_billing_row(db: Session, provider: models.Provider, user: models.User):
     amount_due = get_provider_fees_due(db, provider.id)
     latest_bill = (
         db.query(models.Bill)
         .filter(models.Bill.provider_id == provider.id)
         .order_by(models.Bill.due_date.desc())
         .first()
     )
 
     return {
         "provider_id": provider.id,
         "name": user.full_name or "",
         "account_number": provider.account_number or "",
         "phone": user.phone or "",
         "amount_due_gyd": float(amount_due or 0.0),
         "is_paid": amount_due <= 0,
 
EOF
)