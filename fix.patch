 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/backend/tests/test_billing.py b/backend/tests/test_billing.py
index 6cb74db5ff5210bb6af1ec1cd9c60b3a8e213b4c..eede4401858509e217174624561a07c0d0d6a41b 100644
--- a/backend/tests/test_billing.py
+++ b/backend/tests/test_billing.py
@@ -1058,94 +1058,111 @@ def test_generate_monthly_bills_sends_statement_once_and_marks_emailed_at(db_ses
         session,
         models,
         customer=customer,
         service=service,
         start_time=start_time,
         end_time=end_time,
         status="completed",
     )
 
     sent = []
 
     def _fake_send_monthly_statement_email(to_email, **kwargs):
         sent.append((to_email, kwargs))
 
     monkeypatch.setattr(crud, "send_monthly_statement_email", _fake_send_monthly_statement_email)
 
     crud.generate_monthly_bills(session, month=now.date())
 
     bill = (
         session.query(models.Bill)
         .filter(models.Bill.provider_id == provider.id, models.Bill.month == now.date().replace(day=1))
         .first()
     )
 
     assert bill is not None
-    assert bill.emailed_at is None
-    assert sent == []
+    first_emailed_at = bill.emailed_at
+    assert first_emailed_at is not None
+    assert len(sent) == 1
 
     crud.generate_monthly_bills(session, month=now.date())
-    assert sent == []
+    session.refresh(bill)
 
+    assert len(sent) == 1
+    assert bill.emailed_at == first_emailed_at
 
-def test_generate_monthly_bills_does_not_mark_emailed_when_email_send_fails(db_session, monkeypatch):
+
+def test_generate_monthly_bills_retries_failed_statement_email(db_session, monkeypatch):
     session, models, crud = db_session
     provider, customer, service = _create_provider_graph(session, models)
 
     provider_user = session.query(models.User).filter(models.User.id == provider.user_id).first()
     provider_user.email = "provider@example.com"
     session.commit()
 
     now = now_guyana()
     start_time = _current_month_past_time(now)
     end_time = start_time + timedelta(hours=1)
 
     _add_booking(
         session,
         models,
         customer=customer,
         service=service,
         start_time=start_time,
         end_time=end_time,
         status="completed",
     )
 
-    def _failing_send(*args, **kwargs):
-        raise RuntimeError("sendgrid failed")
+    call_count = 0
+
+    def _flaky_send(*args, **kwargs):
+        nonlocal call_count
+        call_count += 1
+        if call_count == 1:
+            raise RuntimeError("sendgrid failed")
+        return None
 
-    monkeypatch.setattr(crud, "send_monthly_statement_email", _failing_send)
+    monkeypatch.setattr(crud, "send_monthly_statement_email", _flaky_send)
 
     crud.generate_monthly_bills(session, month=now.date())
 
     bill = (
         session.query(models.Bill)
         .filter(models.Bill.provider_id == provider.id, models.Bill.month == now.date().replace(day=1))
         .first()
     )
 
     assert bill is not None
     assert bill.emailed_at is None
+    assert call_count == 1
+
+    crud.generate_monthly_bills(session, month=now.date())
+    session.refresh(bill)
+
+    assert bill.emailed_at is not None
+    assert call_count == 2
 
 
 def test_generate_monthly_bills_snapshots_credits_once(db_session):
     session, models, crud = db_session
     provider, customer, service = _create_provider_graph(session, models)
 
     billing_month = datetime(2023, 1, 1)
     _create_completed_booking_for_month(
         session,
         models,
         customer=customer,
         service=service,
         month_start=billing_month,
         day=2,
         price_gyd=600,
     )
 
     session.add(models.BillCredit(provider_id=provider.id, amount_gyd=Decimal("100.00")))
     session.commit()
 
     crud.generate_monthly_bills(session, month=billing_month.date())
 
     cycle = crud.get_billing_cycle_for_account(session, provider.account_number, billing_month.date())
     bill = (
         session.query(models.Bill)
 
EOF
)