 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/mobile/App.js b/mobile/App.js
index 2e6354797c788910ca21bca1dc3a5542a22ff896..ecb03ad7d3ed1a0542d337d7bdd62e58849605b1 100644
--- a/mobile/App.js
+++ b/mobile/App.js
@@ -137,62 +137,67 @@ const getDistanceKm = (lat1, lon1, lat2, lon2) => {
     Math.cos(toRad(lat1)) *
       Math.cos(toRad(lat2)) *
       Math.sin(dLon / 2) *
       Math.sin(dLon / 2);
   const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
   const distance = R * c;
   return Number.isFinite(distance) ? distance : null;
 };
 
 const getProviderCoords = (provider) => {
   const location = provider?.location;
   const pinnedLocation = provider?.pinned_location ?? provider?.pinnedLocation;
   const coords = provider?.coords;
   const getCoordsFrom = (source) => {
     const lat = toNum(source?.lat ?? source?.latitude);
     const lng = toNum(source?.lng ?? source?.long ?? source?.longitude);
     if (lat == null || lng == null) return null;
     return { lat, lng };
   };
   const lat = toNum(
     provider?.pinned_lat ??
       provider?.pinnedLatitude ??
       provider?.location_lat ??
       provider?.locationLat ??
       provider?.latitude ??
-      provider?.lat
+      provider?.lat ??
+      provider?.user?.lat ??
+      provider?.user?.latitude
   );
   const lng = toNum(
     provider?.pinned_lng ??
       provider?.pinned_long ??
       provider?.pinnedLongitude ??
       provider?.location_lng ??
       provider?.locationLng ??
       provider?.longitude ??
       provider?.lng ??
       provider?.lon ??
-      provider?.long
+      provider?.long ??
+      provider?.user?.long ??
+      provider?.user?.lng ??
+      provider?.user?.longitude
   );
   if (lat != null && lng != null) {
     return { lat, lng };
   }
   const fromLocation = getCoordsFrom(location);
   if (fromLocation) return fromLocation;
   const fromPinned = getCoordsFrom(pinnedLocation);
   if (fromPinned) return fromPinned;
   const fromCoords = getCoordsFrom(coords);
   if (fromCoords) return fromCoords;
   return null;
 };
 
 const LEGACY_ACCESS_TOKEN_KEY = "accessToken";
 
 const getAuthToken = async (tokenState) => {
   if (tokenState?.token) return tokenState.token;
 
   try {
     const secure = await withTimeout(loadToken(), 1500, "loadToken");
     if (secure) return secure;
   } catch (error) {
     console.log("[auth] Failed to load secure token", error?.message || error);
   }
 
 
EOF
)