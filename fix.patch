 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/backend/alembic/versions/8d1f2e3a4b5c_add_billing_cycle_snapshot_fields.py b/backend/alembic/versions/8d1f2e3a4b5c_add_billing_cycle_snapshot_fields.py
index 5b79d377fd55274f518fac18799567dd74325bf8..304b2ddfa9fd1c3a44ec92148cc2b7ae649083be 100644
--- a/backend/alembic/versions/8d1f2e3a4b5c_add_billing_cycle_snapshot_fields.py
+++ b/backend/alembic/versions/8d1f2e3a4b5c_add_billing_cycle_snapshot_fields.py
@@ -1,37 +1,45 @@
 """add billing cycle snapshot fields
 
 Revision ID: 8d1f2e3a4b5c
 Revises: b513cd036ac7
 Create Date: 2026-02-18 00:00:00.000000
 """
 
 from alembic import op
-import sqlalchemy as sa
 
 
 # revision identifiers, used by Alembic.
 revision = "8d1f2e3a4b5c"
 down_revision = "b513cd036ac7"
 branch_labels = None
 depends_on = None
 
 
 def upgrade():
-    op.add_column(
-        "billing_cycles",
-        sa.Column(
-            "credits_applied_gyd",
-            sa.Numeric(precision=10, scale=2),
-            nullable=False,
-            server_default=sa.text("0"),
-        ),
+    op.execute(
+        """
+        ALTER TABLE billing_cycles
+        ADD COLUMN IF NOT EXISTS credits_applied_gyd NUMERIC(10, 2) NOT NULL DEFAULT 0;
+        """
     )
-    op.add_column(
-        "billing_cycles",
-        sa.Column("finalized_at", sa.DateTime(timezone=True), nullable=True),
+    op.execute(
+        """
+        ALTER TABLE billing_cycles
+        ADD COLUMN IF NOT EXISTS finalized_at TIMESTAMPTZ NULL;
+        """
     )
 
 
 def downgrade():
-    op.drop_column("billing_cycles", "finalized_at")
-    op.drop_column("billing_cycles", "credits_applied_gyd")
+    op.execute(
+        """
+        ALTER TABLE billing_cycles
+        DROP COLUMN IF EXISTS finalized_at;
+        """
+    )
+    op.execute(
+        """
+        ALTER TABLE billing_cycles
+        DROP COLUMN IF EXISTS credits_applied_gyd;
+        """
+    )
 
EOF
)